<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Lightweight Cryptography Primitives: Performance of Masked Algorithms</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Lightweight Cryptography Primitives
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Performance of Masked Algorithms </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#perf_masking_intro">Introduction</a></li>
<li class="level1"><a href="#perf_masking_cortex_m3">Performance on ARM Cortex M3</a></li>
<li class="level1"><a href="#perf_masking_rankings">Rankings</a></li>
<li class="level1"><a href="#perf_masking_opt">Optimisation tricks</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="perf_masking_intro"></a>
Introduction</h1>
<p>This page lists performance figures for masked implementations of the algorithms. All figures were calculated on an Arudino Due, which is an ARM Cortex M3 running at 84MHz.</p>
<p>The average performance of the baseline unmasked algorithm is compared with its masked counterpart to produce the figures below. The figures show the amount of overhead. For example, if an algorithm has an overhead of 6.91 for four shares, then that means that the 4-share masked version is on average 6.91 times <b><em>slower</em></b> than the baseline unmasked version.</p>
<p>Ideally, a masked algorithm with N shares would have an overhead of roughly N, but this won't normally be the case. Calls to the system random number generator may be slow: the Arduino Due produces a new random number every 84 clock cycles which can introduce delays. As the number of shares increases, the delays due to random number generation become more significant.</p>
<p>Some algorithms can do better than N. Spook for example only masks the initialization and finalization steps, with the rest using the regular unmasked code. So sometimes Spook does better than N. But as N increases, the random number generation overhead becomes more significant.</p>
<p>"Degree of Masking" in the table below indicates how much of the algorithm runtime is masked. A value of "Init/Final" indicates that initialization and finalization tasks that involve the key are masked but everything else uses the baseline unmasked code. A value of "Init" indicates that only initialization is masked. A value of "Full" indicates that every block operation is fully masked.</p>
<h1><a class="anchor" id="perf_masking_cortex_m3"></a>
Performance on ARM Cortex M3</h1>
<p>Where a NIST submission contains multiple algorithms in a family, <b><em>bold italics</em></b> indicates the primary algorithm in the family. Lower numbers are better.</p>
<table class="doxtable">
<tr>
<td>Algorithm</td><td>Degree of Masking</td><td>2 shares</td><td>3 shares</td><td>4 shares</td><td>5 shares</td><td>6 shares </td></tr>
<tr>
<td><b><em>ASCON-128</em></b></td><td>Init/Final</td><td align="right">3.93</td><td align="right">8.52</td><td align="right">14.40</td><td align="right">23.35</td><td align="right">34.03 </td></tr>
<tr>
<td><b><em>ASCON-128</em></b></td><td>Full</td><td align="right">8.03</td><td align="right">18.36</td><td align="right">33.44</td><td align="right">52.34</td><td align="right">74.72 </td></tr>
<tr>
<td>ASCON-128a</td><td>Init/Final</td><td align="right">4.33</td><td align="right">9.83</td><td align="right">16.71</td><td align="right">27.21</td><td align="right">38.78 </td></tr>
<tr>
<td>ASCON-128a</td><td>Full</td><td align="right">7.48</td><td align="right">17.47</td><td align="right">31.70</td><td align="right">48.52</td><td align="right">69.33 </td></tr>
<tr>
<td>ASCON-80pq</td><td>Init/Final</td><td align="right">3.87</td><td align="right">8.54</td><td align="right">14.44</td><td align="right">23.38</td><td align="right">33.44 </td></tr>
<tr>
<td>ASCON-80pq</td><td>Full</td><td align="right">7.90</td><td align="right">18.39</td><td align="right">33.55</td><td align="right">51.45</td><td align="right">73.47 </td></tr>
<tr>
<td><b><em>GIFT-COFB</em></b></td><td>Full</td><td align="right">6.28</td><td align="right">19.27</td><td align="right">36.84</td><td align="right">62.16</td><td align="right">91.22 </td></tr>
<tr>
<td><b><em>GIMLI-24</em></b></td><td>Init</td><td align="right">2.69</td><td align="right">6.28</td><td align="right">11.93</td><td align="right">19.80</td><td align="right">29.33 </td></tr>
<tr>
<td><b><em>GIMLI-24</em></b></td><td>Full</td><td align="right">10.50</td><td align="right">31.41</td><td align="right">60.37</td><td align="right">106.37</td><td align="right">159.46 </td></tr>
<tr>
<td><b><em>KNOT-AEAD-128-256</em></b></td><td>Init</td><td align="right">2.01</td><td align="right">4.88</td><td align="right">8.09</td><td align="right">12.74</td><td align="right">19.36 </td></tr>
<tr>
<td><b><em>KNOT-AEAD-128-256</em></b></td><td>Full</td><td align="right">6.12</td><td align="right">17.99</td><td align="right">32.06</td><td align="right">52.46</td><td align="right">81.93 </td></tr>
<tr>
<td>KNOT-AEAD-128-384</td><td>Init</td><td align="right">2.92</td><td align="right">7.74</td><td align="right">14.01</td><td align="right">23.93</td><td align="right">35.57 </td></tr>
<tr>
<td>KNOT-AEAD-128-384</td><td>Full</td><td align="right">4.60</td><td align="right">13.91</td><td align="right">26.86</td><td align="right">43.77</td><td align="right">65.54 </td></tr>
<tr>
<td>KNOT-AEAD-192-384</td><td>Init</td><td align="right">2.13</td><td align="right">4.94</td><td align="right">8.62</td><td align="right">14.44</td><td align="right">21.22 </td></tr>
<tr>
<td>KNOT-AEAD-192-384</td><td>Full</td><td align="right">4.67</td><td align="right">14.19</td><td align="right">27.46</td><td align="right">44.74</td><td align="right">67.07 </td></tr>
<tr>
<td>KNOT-AEAD-256-512</td><td>Init</td><td align="right">2.32</td><td align="right">5.47</td><td align="right">9.77</td><td align="right">14.92</td><td align="right">23.67 </td></tr>
<tr>
<td>KNOT-AEAD-256-512</td><td>Full</td><td align="right">4.93</td><td align="right">13.98</td><td align="right">26.97</td><td align="right">43.61</td><td align="right">65.27 </td></tr>
<tr>
<td><b><em>Pyjamask-128-AEAD</em></b></td><td>Full</td><td align="right">2.94</td><td align="right">3.05</td><td align="right">5.31</td><td align="right">5.74</td><td align="right">8.14 </td></tr>
<tr>
<td>Pyjamask-96-AEAD</td><td>Full</td><td align="right">2.94</td><td align="right">3.06</td><td align="right">5.33</td><td align="right">5.73</td><td align="right">8.14 </td></tr>
<tr>
<td><b><em>SPIX</em></b></td><td>Init/Final</td><td align="right">4.55</td><td align="right">12.17</td><td align="right">23.47</td><td align="right">38.60</td><td align="right">59.69 </td></tr>
<tr>
<td><b><em>SPIX</em></b></td><td>Full</td><td align="right">6.64</td><td align="right">19.44</td><td align="right">38.13</td><td align="right">62.76</td><td align="right">93.72 </td></tr>
<tr>
<td>SpoC-128</td><td>Full</td><td align="right">6.65</td><td align="right">19.39</td><td align="right">38.57</td><td align="right">63.26</td><td align="right">95.21 </td></tr>
<tr>
<td><b><em>SpoC-64</em></b></td><td>Full</td><td align="right">4.02</td><td align="right">11.06</td><td align="right">20.38</td><td align="right">35.05</td><td align="right">50.44 </td></tr>
<tr>
<td>Spook-128-384-mu</td><td>Init/Final</td><td align="right">1.71</td><td align="right">3.33</td><td align="right">5.50</td><td align="right">8.07</td><td align="right">11.47 </td></tr>
<tr>
<td>Spook-128-512-mu</td><td>Init/Final</td><td align="right">1.73</td><td align="right">3.35</td><td align="right">5.41</td><td align="right">8.15</td><td align="right">11.22 </td></tr>
<tr>
<td>Spook-128-384-su</td><td>Init/Final</td><td align="right">1.72</td><td align="right">3.34</td><td align="right">5.53</td><td align="right">8.09</td><td align="right">11.52 </td></tr>
<tr>
<td><b><em>Spook-128-512-su</em></b></td><td>Init/Final</td><td align="right">1.74</td><td align="right">3.36</td><td align="right">5.43</td><td align="right">8.17</td><td align="right">11.26 </td></tr>
<tr>
<td><b><em>TinyJAMBU-128</em></b></td><td>Full</td><td align="right">3.16</td><td align="right">8.04</td><td align="right">14.59</td><td align="right">25.65</td><td align="right">43.13 </td></tr>
<tr>
<td>TinyJAMBU-192</td><td>Full</td><td align="right">3.24</td><td align="right">8.25</td><td align="right">14.94</td><td align="right">26.24</td><td align="right">44.27 </td></tr>
<tr>
<td>TinyJAMBU-256</td><td>Full</td><td align="right">3.25</td><td align="right">8.31</td><td align="right">15.08</td><td align="right">26.49</td><td align="right">44.86 </td></tr>
<tr>
<td><b><em>Xoodyak</em></b></td><td>Init</td><td align="right">1.94</td><td align="right">3.76</td><td align="right">6.39</td><td align="right">10.31</td><td align="right">14.51 </td></tr>
<tr>
<td><b><em>Xoodyak</em></b></td><td>Full</td><td align="right">5.89</td><td align="right">15.86</td><td align="right">28.53</td><td align="right">47.70</td><td align="right">69.57 </td></tr>
</table>
<p>It was observed that about 30% of the overhead of the 4-share version was due to Arduino Due's TRNG which produces a new 32-bit random word every 84 clock cycles. The code had to stop and wait for the TRNG quite a bit. On a different CPU with a faster TRNG, the results would be better.</p>
<p>Pyjamask and Spook were designed by the authors with masking in mind as a primary goal and they have been masked according to the authors' recommendations. The other algorithms were not designed with masking as a primary goal.</p>
<p>ISAP and DryGASCON also provide side-channel protection but it is built into the standard design with no masking required. If they were to appear in the above table, all columns would be set to "1.00".</p>
<h1><a class="anchor" id="perf_masking_rankings"></a>
Rankings</h1>
<p>The following table ranks the primary algorithms in increasing order of 4-share overhead:</p>
<table class="doxtable">
<tr>
<td>Algorithm</td><td>Degree of Masking</td><td>4 shares </td></tr>
<tr>
<td>DryGASCON128</td><td>Full</td><td align="right">1.00 </td></tr>
<tr>
<td>ISAP-K-128A</td><td>Init/Final</td><td align="right">1.00 </td></tr>
<tr>
<td>Pyjamask-128-AEAD</td><td>Full</td><td align="right">5.31 </td></tr>
<tr>
<td>Spook-128-512-su</td><td>Init/Final</td><td align="right">5.43 </td></tr>
<tr>
<td>Xoodyak</td><td>Init</td><td align="right">6.39 </td></tr>
<tr>
<td>KNOT-AEAD-128-256</td><td>Init</td><td align="right">8.09 </td></tr>
<tr>
<td>GIMLI-24</td><td>Init</td><td align="right">11.93 </td></tr>
<tr>
<td>ASCON-128</td><td>Init/Final</td><td align="right">14.40 </td></tr>
<tr>
<td>TinyJAMBU-128</td><td>Full</td><td align="right">14.59 </td></tr>
<tr>
<td>SpoC-64</td><td>Full</td><td align="right">20.38 </td></tr>
<tr>
<td>SPIX</td><td>Init/Final</td><td align="right">23.47 </td></tr>
<tr>
<td>Xoodyak</td><td>Full</td><td align="right">28.53 </td></tr>
<tr>
<td>KNOT-AEAD-128-256</td><td>Full</td><td align="right">32.06 </td></tr>
<tr>
<td>ASCON-128</td><td>Full</td><td align="right">33.44 </td></tr>
<tr>
<td>GIFT-COFB</td><td>Full</td><td align="right">36.84 </td></tr>
<tr>
<td>SPIX</td><td>Full</td><td align="right">38.13 </td></tr>
<tr>
<td>GIMLI-24</td><td>Full</td><td align="right">60.37 </td></tr>
</table>
<p>DryGASCON and ISAP have been included for comparison purposes. The baseline versions of those algorithms implement side channel protection without the need for random masking, so their "4 share" value is effectively 1.00.</p>
<p>Pyjamask and Spook are near the head of the table because they were explicitly designed with masking in mind so the overhead is less than the other algorithms. However, the baseline version of Pyjamask is fairly slow in software. So the above table doesn't give a good idea as to the actual software performance.</p>
<p>The following table divides the 4-share overhead by the ChaChaPoly ranking from the main <a class="el" href="performance.html#perf_cortex_m3">ARM Cortex M3</a> performance rankings. This gives an indication as to the relative performance of the masked algorithms in software, with the fastest at the top of the table:</p>
<table class="doxtable">
<tr>
<td>Algorithm</td><td>Degree of Masking</td><td>4 shares</td><td>ChaChaPoly</td><td>4 shares / ChaChaPoly </td></tr>
<tr>
<td>DryGASCON128</td><td>Full</td><td align="right">1.00</td><td align="right">0.22</td><td align="right">4.55 </td></tr>
<tr>
<td>Spook-128-512-su</td><td>Init/Final</td><td align="right">5.43</td><td align="right">0.90</td><td align="right">6.03 </td></tr>
<tr>
<td>Xoodyak</td><td>Init</td><td align="right">6.39</td><td align="right">0.86</td><td align="right">7.43 </td></tr>
<tr>
<td>ASCON-128</td><td>Init/Final</td><td align="right">14.40</td><td align="right">1.11</td><td align="right">12.97 </td></tr>
<tr>
<td>GIMLI-24</td><td>Init</td><td align="right">11.93</td><td align="right">0.91</td><td align="right">13.11 </td></tr>
<tr>
<td>TinyJAMBU-128</td><td>Full</td><td align="right">14.59</td><td align="right">0.81</td><td align="right">18.01 </td></tr>
<tr>
<td>KNOT-AEAD-128-256</td><td>Init</td><td align="right">8.09</td><td align="right">0.38</td><td align="right">21.29 </td></tr>
<tr>
<td>ASCON-128</td><td>Full</td><td align="right">33.44</td><td align="right">1.11</td><td align="right">30.13 </td></tr>
<tr>
<td>Xoodyak</td><td>Full</td><td align="right">28.53</td><td align="right">0.86</td><td align="right">33.17 </td></tr>
<tr>
<td>GIFT-COFB</td><td>Full</td><td align="right">36.84</td><td align="right">1.05</td><td align="right">35.09 </td></tr>
<tr>
<td>ISAP-K-128A</td><td>Init/Final</td><td align="right">1.00</td><td align="right">0.02</td><td align="right">50.00 </td></tr>
<tr>
<td>SPIX</td><td>Init/Final</td><td align="right">23.47</td><td align="right">0.40</td><td align="right">58.68 </td></tr>
<tr>
<td>SpoC-64</td><td>Full</td><td align="right">20.38</td><td align="right">0.31</td><td align="right">65.74 </td></tr>
<tr>
<td>GIMLI-24</td><td>Full</td><td align="right">60.37</td><td align="right">0.91</td><td align="right">66.34 </td></tr>
<tr>
<td>Pyjamask-128-AEAD</td><td>Full</td><td align="right">5.31</td><td align="right">0.07</td><td align="right">75.86 </td></tr>
<tr>
<td>KNOT-AEAD-128-256</td><td>Full</td><td align="right">32.06</td><td align="right">0.38</td><td align="right">84.37 </td></tr>
<tr>
<td>SPIX</td><td>Full</td><td align="right">38.13</td><td align="right">0.40</td><td align="right">95.33 </td></tr>
</table>
<h1><a class="anchor" id="perf_masking_opt"></a>
Optimisation tricks</h1>
<p>This section describes some optimisations for masked ciphers that I encountered while writing the above implementations. These tricks may help other implementers of masked algorithms in C and assembly code.</p>
<p>Random number generation can add a lot of overhead to the runtime. Some CPU's offer a built-in TRNG but it may take a lot of clock cycles to generate each new random word (84 for the Arduino Due). It helps if the RNG calls can be spaced out with more regular instructions between the calls. Then less time is spent polling for the next random word.</p>
<p>Operate on individual shares as much as possible: do everything on A, then everything on B, etc. This reduces the register spills that occur when switching between shares. AND steps are where it becomes difficult because all shares are needed to do those steps. Try to group the simpler XOR masking steps before and after the AND steps so that the shares can be operated on independently in most of the code.</p>
<p>Sometimes it can help to operate on the shares in reverse order just before an AND step. The 3-share AND code operates on A, then B, then C. If the previous steps were operating on C, then B, then A, then A and parts of B are already in registers ready for the start of the AND.</p>
<p>Also see my page on <a class="el" href="masking.html">masking utilities</a>. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Oct 11 2020 14:08:26 for Lightweight Cryptography Primitives by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
